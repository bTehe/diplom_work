{% extends "base.html" %} {% block content %}
<div class="container mt-5">
  <div class="card shadow-sm">
    <div class="card-header bg-info text-white">
      <h3 class="mb-0">üìë –ó–≤—ñ—Ç–∏</h3>
    </div>
    <div class="card-body">
      {# Flash messages #} {% with messages =
      get_flashed_messages(with_categories=true) %} {% if messages %}
      <div class="mb-4">
        {% for category, message in messages %}
        <div
          class="alert alert-{{
            'success' if category=='success' else
            'warning' if category=='warning' else
            'danger'
          }}"
          role="alert"
        >
          {{ message }}
        </div>
        {% endfor %}
      </div>
      {% endif %} {% endwith %} {# Form to generate report #}
      <form method="post" class="row gx-4 gy-4 mb-4">
        <div class="col-md-6">
          <label for="result_file" class="form-label"
            >–§–∞–π–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ inference</label
          >
          <select
            name="result_file"
            id="result_file"
            class="form-control"
            required
          >
            <option value="">‚Äî –û–±–µ—Ä—ñ—Ç—å —Ñ–∞–π–ª ‚Äî</option>
            {% for f in results %}
            <option value="{{ f }}">{{ f }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-4">
          <label for="report_type" class="form-label">–¢–∏–ø –∑–≤—ñ—Ç—É</label>
          <select
            name="report_type"
            id="report_type"
            class="form-control"
            required
          >
            <option value="csv">CSV</option>
            <option value="pdf">PDF</option>
          </select>
        </div>
        <div class="col-md-2 d-flex align-items-end justify-content-end">
          <button type="submit" class="btn btn-info px-4">
            <i class="bi bi-file-earmark-text me-2"></i>–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏
          </button>
        </div>
      </form>

      {% if generated %}
      <div class="alert alert-success mb-4" role="alert">
        –ó–≤—ñ—Ç <strong>{{ generated }}</strong> —É—Å–ø—ñ—à–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ.
      </div>
      {% endif %}

      <hr class="my-4" />

      <h5 class="mb-3">–î–æ—Å—Ç—É–ø–Ω—ñ –∑–≤—ñ—Ç–∏</h5>
      <div class="row gy-3">
        {% for f in existing.csv %}
        <div class="col-md-4">
          <div class="card border-0 shadow-sm h-100">
            <div
              class="card-body d-flex justify-content-between align-items-center"
            >
              <div>
                <i
                  class="bi bi-file-earmark-spreadsheet-fill text-success me-2"
                ></i
                >{{ f }}
              </div>
              <a
                href="{{ url_for('reports.download_report', file=f) }}"
                class="btn btn-sm btn-outline-secondary"
              >
                <i class="bi bi-download"></i>
              </a>
            </div>
          </div>
        </div>
        {% endfor %} {% for f in existing.pdf %}
        <div class="col-md-4">
          <div class="card border-0 shadow-sm h-100">
            <div
              class="card-body d-flex justify-content-between align-items-center"
            >
              <div>
                <i class="bi bi-file-pdf-fill text-danger me-2"></i>{{ f }}
              </div>
              <a
                href="{{ url_for('reports.download_report', file=f) }}"
                class="btn btn-sm btn-outline-secondary"
              >
                <i class="bi bi-download"></i>
              </a>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
